<!DOCTYPE html>
  <html>
    <head>
    <title>How Microsoft Launch Products Affect Microsoft Employee Review 
    </title>
    <style>
      body, p {
        font-family: Arial, Helvetica, sans-serif;
        text-align: center;
        margin-left: 80px;
        margin-right: 80px;
        padding: 50px;}
        
    </style>
    </head>
    <body>

    <h1>How Microsoft Launch Products Affect Employee Review</h1>
    <h4>Sharon Xia <br> INTD-319-S001-2019 <br>Emily Carr University of Art and Design</h4>

    <h2>About the Datasets</h2>
    <p>
    The datasets used for this d3 visualization are important dates from Microsoft official website Facts About Microsoft page, and Google, Amazon and more employee reviews (web scraped over 67k employee reviews for Google, Amazon, Apple, and more) from Kaggle. After I gather those data, I filter them. Select the 10 most popular products Microsoft  launches from 2008 to 2018 and made it into a table. Also, I abstract the employee reviews of Microsoft from the overall employee review dataset, then calculate the average rating of the overall rating, work balance, and career opportunity. Merge these two tables into one table. Each rating information is corresponding to each of the important date of Microsoft.
    </p>

    <h2>Microsoft Employee Reviews</h2> 
    <p>This line chart is a D3 visualization which enable users to view and to compare employee reviews from different aspects based on Microsoft new product launch date. You can view this line chart either individually or with another table below. The two charts using the same date. By comparing them, you can explore how Microsoft launch a product affect employee in different aspects. The red line represents the overall rating; the blue line represents the work-balance rating; the green line represents the career-opportunity rating. (To get the tooltips about detailed data, hover over the line chart)
    </p>


    
<svg width='900' height='450'></svg>
<div id='tooltip' style='position:absolute;background-color:lightgray;padding:5px'></div>
<script src="http://d3js.org/d3.v4.min.js"></script>
<script>
  
// Define margins, dimensions, and some line colors
const margin = {top: 40, right: 120, bottom: 30, left: 40};
const width = 800 - margin.left - margin.right;
const height = 400 - margin.top - margin.bottom;

// Define the scales and tell D3 how to draw the line
const x = d3.scaleLinear().domain([2008, 2018]).range([0, width]);     
const y = d3.scaleLinear().domain([3, 5]).range([height, 0]);
const line = d3.line().x(d => x(d.year)).y(d => y(d.population));

const chart = d3.select('svg').append('g')
  .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');
  
const tooltip = d3.select('#tooltip');
const tooltipLine = chart.append('line');
  
// Add the axes and a title
const xAxis = d3.axisBottom(x).tickFormat(d3.format('.4'));
const yAxis = d3.axisLeft(y).tickFormat(d3.format('.2s'));
chart.append('g').call(yAxis); 
chart.append('g').attr('transform', 'translate(0,' + height + ')').call(xAxis);
chart.append('text').html('Microsoft Employee Reviews').attr('x', 200);
  
// Load the data and draw a chart
let states, tipBox;
d3.json('msemployeereviews.json', d => {
  states = d;

  chart.selectAll()
    .data(states).enter()
    .append('path')
    .attr('fill', 'none')
    .attr('stroke', d => d.color)
    .attr('stroke-width', 2)
    .datum(d => d.history)
    .attr('d', line);
  
  chart.selectAll()
    .data(states).enter()
    .append('text')
    .html(d => d.name)
    .attr('fill', d => d.color)
    .attr('alignment-baseline', 'middle')
    .attr('x', width)
    .attr('dx', '.5em')
    .attr('y', d => y(d.currentPopulation)); 
  
  tipBox = chart.append('rect')
    .attr('width', width)
    .attr('height', height)
    .attr('opacity', 0)
    .on('mousemove', drawTooltip)
    .on('mouseout', removeTooltip);
})

function removeTooltip() {
  if (tooltip) tooltip.style('display', 'none');
  if (tooltipLine) tooltipLine.attr('stroke', 'none');
}

function drawTooltip() {
  
  const year = Math.floor((x.invert(d3.mouse(this)[0])));
  
  states.sort((a, b) => {
    return b.history.find(h => h.year == year).population - a.history.find(h => h.year == year).population;
  })  
    
  tooltipLine.attr('stroke', 'black')
    .attr('x1', x(year))
    .attr('x2', x(year))
    .attr('y1', 0)
    .attr('y2', height);
  
  tooltip.html(year)
    .style('display', 'block')
    .style('left', d3.event.pageX + 10)
    .style('top', d3.event.pageY - 10)
    .selectAll()
    .data(states).enter()
    .append('div')
    .style('color', d => d.color)
    .html(d => d.name + ': ' + d.history.find(h => h.year == year).population);
}
</script>

<h2>New Products Launch Dates</h2> 
    <p>
      The table below shows the most popular products Microsoft launched in each year. Each date is corresponding to the employee review in the above line chart. 
    </p>


<img src="msfacts.png" alt="microsoft facts" width="550" height="500">

<h2>Conclusion</h2>
<p>From the line chart, there is a huge drop in employee reviews between 2008 and 2009. The year of 2008 has the highest employee reviews, and 2009 has the lowest employee reviews over this ten year's peroiod. After 2005, all three categories of rating start an upward tendency. <br> The employee review  might indicates that Windows Server 2008, SQL Server 2008 and Visual Studio 2008 are successful and has a very good impact to Microsoft employees since in 2008, the rating is almost 5. In 2012, the job opportunity rating is higher than other two categories of rating which might imply that the launch of Windows 8 and Surface  lead more job opportunities. In 2013, the work-balance is the lowest which might imply that employees spent more time during Surface 2 and Surface Pro 2 launches perid.

<h6>source: https://news.microsoft.com/facts-about-microsoft/ <br>
           https://www.kaggle.com/petersunga/google-amazon-facebook-employee-reviews <br>
           http://bl.ocks.org/wdickerson/64535aff478e8a9fd9d9facccfef8929</h6>
</body>
</html>